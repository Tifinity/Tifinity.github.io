<!DOCTYPE html>
<html lang="zh-CN">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="Tifinity">
  
  
  
  <link rel="prev" href="http://tifinity.github.io/2019/unity3d%E9%A1%B9%E7%9B%AE%E5%8D%81%E4%B8%80%E7%AE%80%E5%8D%95ar%E6%B8%B8%E6%88%8F/" />
  <link rel="next" href="http://tifinity.github.io/2019/%E5%9B%BD%E9%99%85%E8%AF%AD%E8%A8%80%E4%BB%A3%E7%A0%81%E8%A1%A8/" />
  <link rel="canonical" href="http://tifinity.github.io/2019/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E4%BD%9C%E4%B8%9A1des/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           信息安全作业1：DES | Infinit
       
  </title>
  <meta name="title" content="信息安全作业1：DES | Infinit">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "http:\/\/tifinity.github.io\/"
    },
    "articleSection" : "posts",
    "name" : "信息安全作业1：DES",
    "headline" : "信息安全作业1：DES",
    "description" : "信息安全与技术作业一：DES算法 1.1算法原理概述 1.1.1介绍 Data Encryption Standard (DES) 是一种典型的对称密钥算法，采用块加密方法，运行速度较慢，但较安全。DES 是一种典型的块加密方法：它以64位为分组长度，64位一组的明文作为算法的输入，通过一系列复杂的操作，输出同样 64位长度的密文。DES 使用加密密钥定义变换过程，因此算法认为只有持有加密 所用的密钥的用户才能解密密文。DES 采用64位密钥，但由于每8位中的最后1位用于奇偶校验，实际有效密钥长度为56位。密钥可以是任意的56位的数，且可 随时改变。其中极少量的数被认为是弱密钥，但能容易地避开它们。所有的保密性依赖于密钥。DES 算法的基本过程是换位和置换。\n1.1.2 信息空间 DES的信息空间由 {0, 1} 组成的字符串构成，原始明文消息和经过 DES 加密的密文信息是8个字节 (64位) 的分组，密钥也是64位。 ²\n  原始明文消息按 PKCS#5 (RFC 8018) 规范进行字节填充：\n  原始明文消息最后的分组不够8个字节 (64位) 时，在末尾以字节填满，填入的字节取值相同，都是填充的字节数目；\n  原始明文消息刚好分组完全时，在末尾填充8个字节 (即增 加一个完整分组)，每个字节取值都是08。 ²\n  明文分组结构：M = m1m2 … m64 , mi Î{0, 1}, i = 1 .. 64. ² 密文分组结构：C = c1c2 … c64 , ci Î{0, 1}, i = 1 .",
    "inLanguage" : "zh-CN",
    "author" : "Tifinity",
    "creator" : "Tifinity",
    "publisher": "Tifinity",
    "accountablePerson" : "Tifinity",
    "copyrightHolder" : "Tifinity",
    "copyrightYear" : "2019",
    "datePublished": "2019-12-20 15:11:35 \u002b0800 \u002b0800",
    "dateModified" : "2019-12-20 15:11:35 \u002b0800 \u002b0800",
    "url" : "http:\/\/tifinity.github.io\/2019\/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E4%BD%9C%E4%B8%9A1des\/",
    "wordCount" : "815",
    "keywords" : [ "DES", "Infinit"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="http://tifinity.github.io/">Infinit</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="http://tifinity.github.io/">Infinit</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">信息安全作业1：DES</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="http://tifinity.github.io/" rel="author">Tifinity</a> with ♥ 
                <span class="post-time">
                on <time datetime=2019-12-20 itemprop="datePublished">December 20, 2019</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="http://tifinity.github.io/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"> 信息安全 </a>
                        
                </span>
        </div>
    </header>
    <div class="post-content">
        

        
            
        

        
        
     
          
          
          

          
          
          

          <h1 id="信息安全与技术作业一des算法">信息安全与技术作业一：DES算法</h1>
<h2 id="11算法原理概述">1.1算法原理概述</h2>
<h3 id="111介绍">1.1.1介绍</h3>
<p>Data Encryption Standard (DES) 是一种典型的对称密钥算法，采用块加密方法，运行速度较慢，但较安全。DES 是一种典型的块加密方法：它以64位为分组长度，64位一组的明文作为算法的输入，通过一系列复杂的操作，输出同样 64位长度的密文。DES 使用加密密钥定义变换过程，因此算法认为只有持有加密 所用的密钥的用户才能解密密文。DES 采用64位密钥，但由于每8位中的最后1位用于奇偶校验，实际有效密钥长度为56位。密钥可以是任意的56位的数，且可 随时改变。其中极少量的数被认为是弱密钥，但能容易地避开它们。所有的保密性依赖于密钥。DES 算法的基本过程是换位和置换。</p>
<h3 id="112-信息空间">1.1.2 信息空间</h3>
<p>DES的信息空间由 {0, 1} 组成的字符串构成，原始明文消息和经过 DES 加密的密文信息是8个字节 (64位) 的分组，密钥也是64位。 ²</p>
<ul>
<li>
<p>原始明文消息按 PKCS#5 (RFC 8018) 规范进行字节填充：</p>
</li>
<li>
<p>原始明文消息最后的分组不够8个字节 (64位) 时，在末尾以字节填满，填入的字节取值相同，都是填充的字节数目；</p>
</li>
<li>
<p>原始明文消息刚好分组完全时，在末尾填充8个字节 (即增 加一个完整分组)，每个字节取值都是08。 ²</p>
</li>
<li>
<p>明文分组结构：M = m1m2 … m64 , mi Î{0, 1}, i = 1 .. 64. ² 密文分组结构：C = c1c2 … c64 , ci Î{0, 1}, i = 1 .. 64. ²</p>
</li>
<li>
<p>密钥结构：K = k1k2 … k64 , ki Î{0, 1}, i = 1 .. 64.</p>
</li>
<li>
<p>除去 k8, k16, …, k64 共8位奇偶校验位，起作用的仅56位。</p>
</li>
<li>
<p>算法过程用到的16个密钥记为 K1, K2, …, K16。</p>
</li>
</ul>
<h3 id="113-算法过程">1.1.3 算法过程</h3>
<p>DES加密过程：</p>
<p>C = Ek(M) = IP-1 · W · T16 · T15 ·… · T1 · IP(M).</p>
<ul>
<li>
<p>M 为算法输入的64位明文块；</p>
</li>
<li>
<p>Ek 描述以 K 为密钥的加密函数，由连续的过程复合构成；</p>
</li>
<li>
<p>IP 为64位初始置换；</p>
</li>
<li>
<p>T1, T2 , …, T16 是一系列的迭代变换；</p>
</li>
<li>
<p>W 为64位置换，将输入的高32位和低32位交换后输出；</p>
</li>
<li>
<p>IP-1 是 IP 的逆置换；</p>
</li>
<li>
<p>C 为算法输出的64位密文块。</p>
</li>
</ul>
<p>DES的解密过程与加密完全相同，只不过从后向前使用子密钥列表。</p>
<p>M = Dk(C) = IP-1 · W · T1 · T2 · … · T16 · IP (C).</p>
<h2 id="12-总体结构">1.2 总体结构</h2>
<p><img src="https://github.com/Tifinity/MyImage/raw/master/WebSecurity/hw1DES/image-20191220151904677.png" alt="image-20191220151904677"></p>
<h2 id="13-模块分解">1.3 模块分解</h2>
<h3 id="131-ip初始置换">1.3.1 IP初始置换</h3>
<p>根据初始置换表对输入明文进行置换，置换过程就是把输入数据的第58位放到第1位，50位放到第2位，42位放到第3位，以此类推，初始置换以后得到的是一个64位的输出。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#75715e">//ip初始置换表  
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> DES<span style="color:#f92672">::</span>ip[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> { <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>,
                    <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>,
                    <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">6</span>,
                    <span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">8</span>,
                    <span style="color:#ae81ff">57</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">9</span>,  <span style="color:#ae81ff">1</span>,
                    <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>,
                    <span style="color:#ae81ff">61</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">5</span>,
                    <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">7</span> };  
  
<span style="color:#75715e">//ip置换    
</span><span style="color:#75715e"></span>bitset<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">64</span><span style="color:#f92672">&gt;</span> DES<span style="color:#f92672">::</span>IP(<span style="color:#66d9ef">const</span> bitset<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">64</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span> plain) {    
    bitset<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">64</span><span style="color:#f92672">&gt;</span> M;    
    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">64</span>; i<span style="color:#f92672">++</span>) {          
            M[i] <span style="color:#f92672">=</span> plain[ip[i] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>];    
    }    
    <span style="color:#66d9ef">return</span> M;    
}  
</code></pre></div><h3 id="132-生成子密钥">1.3.2 生成子密钥</h3>
<p>用户将初始密钥输入到子密钥生成器中，首先经过PC_1置换选择去掉8位奇偶校验位，留下真正的56bit有效密钥。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">56</span>; i<span style="color:#f92672">++</span>) {  
    real_key[i] <span style="color:#f92672">=</span> key[PC_1[i] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>];  
}  
</code></pre></div><p>接着，分成两部分left和right，每部分28bit，左右两部分分别循环左移，每部分循环左移，每轮次根据轮次移位表左移位数不同，然后再连接成56bit。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#75715e">//轮次位移表  
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> shiftBits[] <span style="color:#f92672">=</span> { <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span> };
</code></pre></div><p>再使用PC_2重排并压缩为48bit，即得到一个子密钥。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> round <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; round <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">16</span>; round<span style="color:#f92672">++</span>) {  
    left_shift(left, shiftBits[round]);  
    left_shift(right, shiftBits[round]);  
    <span style="color:#75715e">//合并左右部分  
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">28</span>; <span style="color:#f92672">++</span>i) {  
        real_key[i] <span style="color:#f92672">=</span> right[i];  
        real_key[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> left[i];  
    }  
    <span style="color:#75715e">//使用PC_2重排并压缩为48位  
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">48</span>; j<span style="color:#f92672">++</span>) {  
        subkeys[round][<span style="color:#ae81ff">47</span> <span style="color:#f92672">-</span> j] <span style="color:#f92672">=</span> real_key[<span style="color:#ae81ff">56</span> <span style="color:#f92672">-</span> PC_2[j]];  
    }  
}  
</code></pre></div><p>进行16轮得到16个子密钥。</p>
<p>PC_1和PC_2如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#75715e">//置换选择PC_1  
</span><span style="color:#75715e">//64bit密钥转为56bit  
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> DES<span style="color:#f92672">::</span>PC_1[<span style="color:#ae81ff">56</span>] <span style="color:#f92672">=</span> { <span style="color:#ae81ff">57</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">9</span>,  
                    <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">18</span>,  
                    <span style="color:#ae81ff">10</span>,  <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">27</span>,  
                    <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">11</span>,  <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">36</span>,  
                    <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">15</span>,  
                    <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">22</span>,  
                    <span style="color:#ae81ff">14</span>,  <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">61</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">29</span>,  
                    <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">13</span>,  <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">12</span>,  <span style="color:#ae81ff">4</span> };  
  
<span style="color:#75715e">//置换选择PC_2  
</span><span style="color:#75715e">//56bit密钥转为48bit  
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> DES<span style="color:#f92672">::</span>PC_2[<span style="color:#ae81ff">48</span>] <span style="color:#f92672">=</span> { <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">24</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">5</span>,  
                    <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">15</span>,  <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">10</span>,  
                    <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">12</span>,  <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">26</span>,  <span style="color:#ae81ff">8</span>,  
                    <span style="color:#ae81ff">16</span>,  <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">13</span>,  <span style="color:#ae81ff">2</span>,  
                    <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">55</span>,  
                    <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">48</span>,  
                    <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">53</span>,  
                    <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">32</span> };  
</code></pre></div><h3 id="133-feistel轮函数">1.3.3 Feistel轮函数</h3>
<p>F接受两个参数：32位的data和48位的subkey。</p>
<p>E盒拓展，使用E置换表将data从32位扩展为48位。输出的每一位为</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#75715e">//E盒扩展  
</span><span style="color:#75715e"></span>bitset<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">48</span><span style="color:#f92672">&gt;</span> expand;  
<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">48</span>; i<span style="color:#f92672">++</span>) {  
    expand[i] <span style="color:#f92672">=</span> data[E[i] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>];  
}  
</code></pre></div><p>密钥异或，将得到的48bit输出作为输入与对应的48bit子密钥进行异或运算。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#75715e">//异或  
</span><span style="color:#75715e"></span>expand <span style="color:#f92672">=</span> expand <span style="color:#f92672">^</span> subkey;  
</code></pre></div><p>S盒压缩，将异或之后得到48bit作为S盒输入，分成8组，每组6bit，分别进入8个S盒进行压缩，最终输入48bit变为输出32bit。DES共有8个S盒，每个S盒有4行16列，每个元素4bit但一般用十进制表示。S盒接收到6bit的输入，6bit中的第一个bit和最后一个bit构成2位二进制数为行号，6bit中间的4bit二进制为列号，然后根据行号和列号查该S盒得到对应的值，该值的二进制就是S盒变换的输出。S盒压缩是DES算法唯一的非线性变换，提高了DES算法的安全性。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#75715e">//S盒压缩  
</span><span style="color:#75715e"></span>bitset<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">32</span><span style="color:#f92672">&gt;</span> output;  
<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>; i<span style="color:#f92672">++</span>) {  
    <span style="color:#66d9ef">int</span> pos <span style="color:#f92672">=</span> <span style="color:#ae81ff">47</span> <span style="color:#f92672">-</span> i <span style="color:#f92672">*</span> <span style="color:#ae81ff">6</span>;   
    <span style="color:#66d9ef">int</span> row <span style="color:#f92672">=</span> expand[pos] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> expand[pos <span style="color:#f92672">-</span> <span style="color:#ae81ff">5</span>];  
    <span style="color:#66d9ef">int</span> col <span style="color:#f92672">=</span> expand[pos <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">+</span> expand[pos <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">+</span> expand[pos <span style="color:#f92672">-</span> <span style="color:#ae81ff">3</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> expand[pos <span style="color:#f92672">-</span> <span style="color:#ae81ff">4</span>];  
    bitset<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">4</span><span style="color:#f92672">&gt;</span> result(S_BOX[i][row][col]);  
    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">4</span>; j<span style="color:#f92672">++</span>) {  
        output[<span style="color:#ae81ff">31</span> <span style="color:#f92672">-</span> i <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">-</span> j] <span style="color:#f92672">=</span> result[<span style="color:#ae81ff">3</span> <span style="color:#f92672">-</span> j];  
    }  
} 
</code></pre></div><p>最后进行P盒置换，P置换类似于IP初始置换。</p>
<p>E置换表和P置换表：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#75715e">//E盒扩展置换表  
</span><span style="color:#75715e">//将32bit扩展为48bit  
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> DES<span style="color:#f92672">::</span>E[<span style="color:#ae81ff">48</span>] <span style="color:#f92672">=</span> { <span style="color:#ae81ff">32</span>,  <span style="color:#ae81ff">1</span>,  <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">4</span>,  <span style="color:#ae81ff">5</span>,  
                    <span style="color:#ae81ff">4</span>,  <span style="color:#ae81ff">5</span>,  <span style="color:#ae81ff">6</span>,  <span style="color:#ae81ff">7</span>,  <span style="color:#ae81ff">8</span>,  <span style="color:#ae81ff">9</span>,  
                    <span style="color:#ae81ff">8</span>,  <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>,  
                   <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">17</span>,  
                   <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">21</span>,  
                   <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">25</span>,  
                   <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">29</span>,  
                   <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">32</span>,  <span style="color:#ae81ff">1</span> };  
<span style="color:#75715e">//P盒置换表  
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> DES<span style="color:#f92672">::</span>P[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> { <span style="color:#ae81ff">16</span>,  <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">21</span>,  
                    <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">17</span>,  
                    <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">26</span>,  
                    <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">10</span>,  
                    <span style="color:#ae81ff">2</span>,  <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">14</span>,  
                    <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">27</span>,  <span style="color:#ae81ff">3</span>,  <span style="color:#ae81ff">9</span>,  
                    <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">30</span>,  <span style="color:#ae81ff">6</span>,  
                    <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">11</span>,  <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">25</span> }; 

</code></pre></div><h3 id="134-ip逆置换">1.3.4 IP逆置换</h3>
<p>过程与IP初始置换完全相同，只不过使用的置换表不同。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#75715e">//IP逆置换  
</span><span style="color:#75715e"></span>bitset<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">64</span><span style="color:#f92672">&gt;</span> DES<span style="color:#f92672">::</span>IP_1(<span style="color:#66d9ef">const</span> bitset<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">64</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&amp;</span> input) {  
    bitset<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">64</span><span style="color:#f92672">&gt;</span> output;  
    <span style="color:#66d9ef">int</span> ip_1[<span style="color:#ae81ff">64</span>];  
    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">64</span>; i<span style="color:#f92672">++</span>) {  
        ip_1[ip[i] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;  
    }  
    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">64</span>; i<span style="color:#f92672">++</span>) {  
        output[i] <span style="color:#f92672">=</span> input[ip_1[i] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>];  
    }  
    <span style="color:#66d9ef">return</span> output;  
} 

</code></pre></div><p>IP逆置换表。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#75715e">//IP逆置换表  
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> DES<span style="color:#f92672">::</span>IP_1[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> {  
    <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">32</span>,  
    <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">31</span>,  
    <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">30</span>,  
    <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">61</span>, <span style="color:#ae81ff">29</span>,  
    <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">28</span>,  
    <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">27</span>,  
    <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">26</span>,  
    <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">41</span>,  <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">57</span>, <span style="color:#ae81ff">25</span>  
};

</code></pre></div><h2 id="14-数据结构">1.4 数据结构</h2>
<p>除S置换表之外的置换表都使用一维数组表示。</p>
<p>S置换表使用三维数组表示，每一个S盒为二维数组。</p>
<p>密钥，数据等使用bitset表示，方便进行位操作。</p>
<p>子密钥列表使用bitset的一维数组表示。</p>
<h2 id="15-源代码">1.5 源代码</h2>
<p>见<a href="https://github.com/Tifinity/WebSecurity-Learning/tree/master/is_ss2017_17343105_%E7%94%B0%E7%9A%93_assign_1">Github</a></p>
<h2 id="16-运行结果">1.6 运行结果</h2>
<p>可以处理任意类型的文件</p>
<p><img src="https://github.com/Tifinity/MyImage/raw/master/WebSecurity/hw1DES/image-20191220160546730.png" alt="image-20191220160546730"></p>
<p><img src="https://github.com/Tifinity/MyImage/raw/master/WebSecurity/hw1DES/image-20191220160554962.png" alt="image-20191220160554962"></p>
<p><img src="https://github.com/Tifinity/MyImage/raw/master/WebSecurity/hw1DES/image-20191220160600729.png" alt="image-20191220160600729"></p>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>Tifinity </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=http://tifinity.github.io/2019/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E4%BD%9C%E4%B8%9A1des/>http://tifinity.github.io/2019/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E4%BD%9C%E4%B8%9A1des/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target = "_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="http://tifinity.github.io/tags/des/">
                    #DES</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="http://tifinity.github.io/">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="http://tifinity.github.io/2019/unity3d%E9%A1%B9%E7%9B%AE%E5%8D%81%E4%B8%80%E7%AE%80%E5%8D%95ar%E6%B8%B8%E6%88%8F/" class="prev" rel="prev" title="Unity3D项目十一：简单AR"><i class="iconfont icon-left"></i>&nbsp;Unity3D项目十一：简单AR</a>
         
        
        <a href="http://tifinity.github.io/2019/%E5%9B%BD%E9%99%85%E8%AF%AD%E8%A8%80%E4%BB%A3%E7%A0%81%E8%A1%A8/" class="next" rel="next" title="国际语言代码表">国际语言代码表&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
          
                 
          
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2019 - 2021</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="http://tifinity.github.io/">Tifinity</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span> 
    </div>
</footer>












    
     <link href="//lib.baomitu.com/lightgallery/1.6.11/css/lightgallery.min.css" rel="stylesheet">  
      
     <script src="/js/vendor_gallery.min.js" async="" ></script>
    
  



     </div>
  </body>
</html>
